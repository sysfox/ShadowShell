# ShadowShell

## 项目概述

ShadowShell 是一个高度模块化的Shell生成器，专为渗透测试和安全研究设计。该工具提供了加密的反向Shell客户端生成功能，具有高级混淆和反检测特性。

⚠️ **重要声明：此工具仅用于授权的渗透测试和安全研究，使用前请确保获得明确授权并遵守当地法律法规。**

## 项目结构

```
WS/
├── main.py                 # 主程序入口
├── modules/               # 模块化代码
│   ├── __init__.py        # 模块初始化
│   ├── cipher.py          # 加密解密模块
│   ├── code_generator.py  # 代码生成模块
│   ├── anti_detection.py  # 反检测模块
│   ├── shell_generator.py # Shell文件生成模块
│   ├── utils.py           # 工具函数模块
│   └── ui.py              # 用户界面模块
└── README.md              # 项目文档
```

## 功能特性

### 🔐 加密功能
- **多层加密**：XOR + 自定义算法 + Base64 + 压缩
- **随机密钥生成**：支持自定义长度和字符集
- **密钥强度控制**：可选择包含特殊字符

### 🛡️ 反检测功能
- **反调试检测**：检测常见调试器和分析工具
- **反沙箱检测**：多重沙箱环境识别
- **反虚拟机检测**：VM特征文件和注册表检测
- **时间检测**：检测时间加速和分析延迟
- **网络检测**：验证真实网络环境

### 🎯 代码混淆
- **变量名随机化**：避免特征检测
- **假代码注入**：添加无害的干扰代码
- **分阶段执行**：多阶段载荷投递
- **导入混淆**：随机化导入顺序

### 🔄 持久化支持
- **Windows持久化**：启动项和注册表
- **Linux持久化**：自启动配置
- **跨平台兼容**：自动检测操作系统

## 使用方法

### 交互式模式
```bash
python3 main.py
```

### 命令行模式
```bash
python3 main.py -i 192.168.1.100 -p 4444 --anti-detection --use-dropper
```

### 命令行参数
```
-i, --ip              监听IP地址 (必需)
-p, --port            监听端口 (必需)
-r, --retry           连接重试次数 (默认: 10)
-d, --delay           重试间隔秒数 (默认: 5)
-k, --key-length      密钥长度 (默认: 16)
-o, --output          输出目录 (默认: 当前目录)
-f, --filename        自定义文件名
--persistence         添加持久化功能
--anti-detection      添加反杀毒特征
--use-dropper         使用分阶段执行模式
--quiet               静默模式
--silent-delay        执行前延迟时间 (默认: 30秒)
```

## 模块说明

### cipher.py - 加密模块
提供高级加密功能，包括：
- `AdvancedCipher`类：多层加密实现
- `gene_key()`：基础密钥生成
- `gene_advanced_key()`：高强度密钥生成

### code_generator.py - 代码生成模块
负责生成Shell连接代码：
- `gene_code()`：简单版本代码生成
- `gene_code_obfuscated()`：混淆版本代码生成
- `advanced_obfuscate_code()`：高级代码混淆

### anti_detection.py - 反检测模块
实现各种反检测技术：
- 反调试检测
- 反沙箱检测
- 反虚拟机检测
- 环境验证

### shell_generator.py - Shell生成模块
生成最终的Shell文件：
- `gene_shell()`：标准Shell文件生成
- `create_payload_dropper()`：分阶段执行文件生成

### utils.py - 工具模块
提供辅助功能：
- IP和端口验证
- 配置文件生成
- 结果输出格式化

### ui.py - 用户界面模块
处理用户交互：
- 交互式界面
- 命令行参数解析

## 安全注意事项

1. **授权使用**：仅在获得明确授权的环境中使用
2. **法律合规**：遵守当地法律法规
3. **责任使用**：用户对使用后果承担全部责任
4. **测试环境**：建议在隔离的测试环境中使用

## 技术细节

### 加密流程
1. 原始代码 → XOR加密
2. XOR结果 → 自定义算法加密
3. 加密结果 → Base64编码 + zlib压缩

### 反检测流程
1. 环境初始化检查
2. 反调试检测
3. 反沙箱检测
4. 延迟执行
5. 载荷解密执行

### 混淆技术
- 变量名随机化
- 代码结构打乱
- 假函数和变量注入
- 动态执行路径

## 开发者信息

- **项目名称**: ShadowShell
- **版本**: 2.0.0
- **作者**: Teror Fox
- **GitHub**: [@sysfox](https://github.com/sysfox)
- **更新日期**: 2025年7月30日

## 更新日志

### v2.0.0 (2025-07-30)
- 完全重构为模块化架构
- 增强反检测功能
- 改进代码混淆技术
- 添加分阶段执行模式
- 优化用户界面

### v1.0.0
- 初始版本
- 基础加密和Shell生成功能

## 许可证

本项目仅供教育和研究目的使用。使用者需承担使用此工具的全部法律责任。

---

**免责声明**：此工具的开发目的是为了帮助安全研究人员和渗透测试人员评估系统安全性。任何恶意使用此工具的行为都是被严格禁止的，开发者对此类行为不承担任何责任。
